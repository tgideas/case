function XMANSlide(e,t){function n(){$.each(v.slide,function(e,n){for(var a=$(n).find('[data-parent="'+t.animationFromWhich+'"]').addClass(t.animationClassName),i=a.length,s=[],r=0;i>r;r++)s.push(a.eq(r)),B[e]=s})}function a(){var e,n,a="",i=w.support.translate3d?"translate3d(0px,0px,0px)":"translate(0px,0px)";a+="."+t.selectorClassName+"{ "+w.setCssText("transition-property","transform, left, top")+w.setCssText("transition-duration","0s")+w.setCssText("transform",i)+w.setCssText("transition-timing-function","ease")+"}","y"===t.direction?(a+="#"+v.id+"{ "+w.setCssText("width","100%")+w.setCssText("height",100*v.slideLength+"%")+"}#"+v.id+" > ."+t.childClassName+"{"+w.setCssText("width","100%")+w.setCssText("height",100/v.slideLength+"%")+"}",n=t.fullScreen?w.help.getWinHeight():w.help.getElementHeight(v.selector.parent()),x=n*v.slideLength,N=n):(a+="#"+v.id+"{ "+w.setCssText("width",100*v.slideLength+"%")+w.setCssText("height","100%")+w.setCssText("display","box")+"}#"+v.id+" > ."+t.childClassName+"{"+w.setCssText("width","100%")+w.setCssText("height","100%")+w.setCssText("box-flex",1)+"}",e=t.fullScreen?w.help.getWinWidth():w.help.getElementWidth(v.selector.parent()),x=e*v.slideLength,N=e);for(var s=0,r=0;r<v.slideLength;r++)s=r*N,S.push(s);return a}function i(){v.selector.on(w.touchEvent.touchStart,u).on(w.touchEvent.touchMove,h).on(w.touchEvent.touchEnd,f).on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",w.debounce(function(){e[0].className=t.selectorClassName+" "+t.selectorClassName+"-"+(v.activeSlide+1)},300))}function s(){var e="";return e+="."+t.animationClassName+"{"+w.setCssText("display","none")+"}",$.each(B,function(n,a){for(var i=a.length,s=Math.floor(n)+1,r=0;i>r;r++){var o=a[r],l=o.attr("data-item"),c=o.attr("data-animation"),d=(o.attr("data-duration")/1e3||1)+"s",u=o.attr("data-timing-function")||"ease",h=o.attr("data-delay")/1e3+"s",f=o.attr("data-iteration-count")||1,v="."+t.selectorClassName+"-"+s+" ."+t.innerPageClassName+"-"+s+" ."+l;e+=v+"{"+w.setCssText("display","block")+w.setCssText("animation-name",c)+w.setCssText("animation-duration",d)+w.setCssText("animation-timing-function",u)+w.setCssText("animation-delay",h)+w.setCssText("animation-fill-mode","both")+w.setCssText("animation-iteration-count",f)+"}"}}),e}function r(){for(var e='<div class="'+t.navClassName+'">',n=0;n<v.slideLength;n++)e+=0===n?'<a class="'+t.navChildClassName+" "+t.navChileCurrentClassName+'" href="javascript:;">'+(n+1)+"</a>":'<a class="'+t.navChildClassName+'" href="javascript:;">'+(n+1)+"</a>";e+="</div>",v.selector.after(e),v.navigation=v.selector.siblings("."+t.navClassName),v.navItem=v.navigation.find("."+t.navChildClassName),v.currentNavItem=v.navigation.find("."+t.navChileCurrentClassName)}function o(e){v.currentNavItem.removeClass(t.navChileCurrentClassName),v.currentNavItem=v.navItem.eq(e),v.currentNavItem.addClass(t.navChileCurrentClassName)}function l(){$("."+t.navClassName).on(w.touchEvent.touchEnd,"."+t.navChildClassName,function(){var e=$(this),t=e.index();v.swipeTo(t)})}function c(){var e=x-N;return 0>e&&(e=0),e}function d(e){var n=t.speed;w.setTranslate(v.selector[0],X,e),w.setTransitionDuration(v.selector[0],n),t.navigation&&o(v.activeSlide),"function"==typeof t.onChangeEndCB&&t.onChangeEndCB(v.activeSlide)}function u(e){if(E)return!1;E=!0,"function"==typeof t.onTouchStartCB&&t.onTouchStartCB(v.activeSlide),y="touchstart"===e.type;var n=e.targetTouches,a=y?n[0].pageX:e.pageX||e.clientX,i=y?n[0].pageY:e.pageY||e.clientY;R.startX=R.currentX=a,R.startY=R.currentY=i,R.start=R.current=M?a:i,Y.start=Y.current=w.getTranslate(v.selector[0],v.params.direction),w.setTransitionDuration(v.selector[0],0),w.setTranslate(v.selector[0],X,Y.start),L.start=(new Date).getTime(),T=void 0,t.moveStartThreshold>0&&(g=!1)}function h(e){if(E&&(!y||"mousemove"!==e.type)){var n=e.targetTouches,a=y?n[0].pageX:e.pageX||e.clientY,i=y?n[0].pageY:e.pageY||e.clientY;if("undefined"==typeof T&&M&&(T=!!(T||Math.abs(i-R.startY)>Math.abs(a-R.startX))),"undefined"!=typeof T||M||(T=!!(T||Math.abs(i-R.startX)<Math.abs(a-R.startX))),T)return void(E=!1);if(e.nested)return void(E=!1);if(e.nested=!0,b=!0,e.preventDefault(),R.current=M?a:i,Y.current=(R.current-R.start)*t.touchRatio+Y.start,Math.abs(R.current-R.start)>t.moveStartThreshold||g){if(!g)return g=!0,void(R.start=R.current);w.debounce(w.setTranslate(v.selector[0],X,Y.current),300)}else Y.current=Y.start;"function"==typeof t.onTouchMove&&w.debounce(t.onTouchMove(Y.current),300)}}function f(){T&&v.swipeReset(),E=!1,Y.current||0===Y.current||(Y.current=Y.start),L.end=(new Date).getTime(),R.diff=R.current-R.start,R.abs=Math.abs(R.diff),Y.diff=Y.current-Y.start,Y.abs=Math.abs(Y.diff);var e=Y.diff,n=Y.abs,a=L.end-L.start,i=0>e?"next":"prev";300>=a?5>n?0===n&&v.swipeReset():("next"===i&&(30>n?v.swipeReset():v.swipeNext()),"prev"===i&&(30>n?v.swipeReset():v.swipePrev())):("next"===i&&(n>=N*t.swipeRatio?v.swipeNext():v.swipeReset()),"prev"===i&&(n>=N*t.swipeRatio?v.swipePrev():v.swipeReset())),t.navigation&&o(v.activeSlide),"function"==typeof t.onTouchEndCB&&t.onTouchEndCB(v.activeSlide)}if("undefined"!=typeof e&&(e.nodeType||0!==$(e).length)){var v=this,C={selectorClassName:"slide-layout",childClassName:"slide-layout__page",animationClassName:"animation",animationFromWhich:e[0].id,innerPageClassName:"page",direction:"x",navigation:!1,navigationAllowClick:!1,navClassName:"slide-nav",navChildClassName:"nav-item",navChileCurrentClassName:"nav-item--current",fullScreen:!0,allowEndBounce:!0,touchRatio:1.2,swipeRatio:.3,moveStartThreshold:80,speed:300,onTouchStartCB:null,onTouchEndCB:null,onChangeStartCB:null,onChangeEndCB:null,onTouchMove:null};t=t||{};for(var p in C)if(p in t&&"object"==typeof t[p])for(var m in C[p])m in t[p]||(t[p][m]=C[p][m]);else p in t||(t[p]=C[p]);v.selector=e,v.params=t;var g,T,N,x,w=new XMANBase,S=[],E=!1,b=!1,y=!1,M="x"===t.direction;v.id=v.selector[0].id,v.slide=v.selector.children("div."+t.childClassName),v.slideLength=v.slide.length,v.activeSlide=0;var B={},X={direction:t.direction,allowEndBounce:t.allowEndBounce};v.init=function(){var o=this,d=o.selector.closest(".container"),u=$("html"),h=w.touchEvent,f="";t.fullScreen&&d.height(w.help.getWinHeight()),window.scrollTo(0,1),u.on(h.touchMove,function(e){e.preventDefault()}),n(),f+=a()+s(),w.insertCss(f),i(),t.navigation&&(r(),t.navigationAllowClick&&l()),e[0].className=t.selectorClassName+" "+t.selectorClassName+"-"+(o.activeSlide+1),X.maxPosition=c(),"function"==typeof t.onChangeEndCB&&t.onChangeEndCB(o.activeSlide)},v.offEvent=function(){v.selector.off(w.touchEvent.touchStart).off(w.touchEvent.touchMove).off(w.touchEvent.touchEnd)};var R={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,diff:0,abs:0},Y={start:0,abs:0,diff:0,current:0},L={start:0,end:0};v.swipeNext=function(){var e,n=w.getTranslate(v.selector[0],v.params.direction);return e=-(Math.floor(Math.abs(n)/Math.floor(N))*N+N),e=e<-c()?-c():e,e===n?!1:("function"==typeof t.onChangeStartCB&&t.onChangeStartCB(v.activeSlide),v.activeSlide=v.activeSlide>=v.slideLength-1?v.slideLength-1:-e/N,d(e,"next"),!0)},v.swipePrev=function(){var e,n=w.getTranslate(v.selector[0],v.params.direction);return e=-(Math.ceil(-n/N)-1)*N,e=e>0?0:e,e===n?!1:("function"==typeof t.onChangeStartCB&&t.onChangeStartCB(v.activeSlide),v.activeSlide=v.activeSlide<=0?0:-e/N,d(e,"prev"),!0)},v.swipeReset=function(){var e,t=w.getTranslate(v.selector[0],v.params.direction),n=-c();e=0;for(var a=0;a<S.length;a++){if(-t===S[a])return;if(-t>=S[a]&&-t<S[a+1]){e=Y.diff>0?-S[a+1]:-S[a];break}}return e=-t>=S[S.length-1]?-S[S.length-1]:e,e=n>=t?n:e,e===t?!1:(d(e,"reset"),!0)},v.swipeTo=function(e){if(e=parseInt(e,10),!(e>v.slideLength-1||0>e)){var t,n=w.getTranslate(v.selector[0],v.params.direction);return t=-e*N,t=t<-c()?-c():t,t===n?!1:(v.activeSlide=e,d(t,"swipeTo"),!0)}}}}XMANSlide.prototype={constructor:XMANSlide},window.Zepto&&!function(e){"use strict";e.fn.XMANSlide=function(t){var n;return this.each(function(a){var i=e(this);if(!i.data("slide")){var s=new XMANSlide(i,t);a||(n=s),s.init(),i.data("slide",s)}}),n}}(window.Zepto);